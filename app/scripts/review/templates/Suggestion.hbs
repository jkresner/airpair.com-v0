<article class="entry">

  <span class="alignright social-icons">
    {{#with expert}}
      {{#if gh}}<a href="//github.com/{{ gh.username }}" target="_blank" class="github"></a>{{/if}}
      {{#if so}}<a href="//stackoverflow.com/users/{{ so.link }}" target="_blank" class="stackoverflow"></a>{{/if }}
      {{#if bb}}<a href="//bitbucket.org/{{ bb.id }}" target="_blank" class="bitbucket"></a>{{/if}}
      {{#if in}}<a href="//linkedin.com/x/profile/sy5n2q8o2i49/{{ in.id }}" target="_blank" class="linkedin"></a>{{/if}}
      {{#if tw}}<a href="//twitter.com/{{ tw.username }}" target="_blank" class="twitter"></a>{{/if}}
    {{/with}}
  </span>
  <span class="alignleft">
    <img src="{{expert.pic}}?s=200" class="avatar user" />
  </span>
  <header class="entry-header">
    <h2 class="entry-title"><span class="label label-status label-{{ expertStatus }}">{{ expertStatus }}</span></h2>
    <span class="entry-author">
      {{#if expert.homepage}}
        <a href="http://{{expert.homepage}}" target="_blank" class="guest">
          {{expert.name}}
        </a>
      {{else}}
        {{expert.name}}
      {{/if}}
    </span>
    {{#if isCustomer}}
    <label>${{ rates.total }} p.h.</label>
    {{/if}}
  </header>

  <div class="entry-content">
    {{#if expertComment }}
      {{markdown expertComment }}
      <b>Availability</b>
      {{markdown expertAvailability }}
    {{/if}}
    <a href="/schedule/{{requestId}}" class="schedule green button">Schedule a call with {{expert.firstName}}</a>

    <br>
    <br>
    <h2>Calls</h2>
    {{#each calls}}
    <div class="call {{status}}">
      <h5>{{type}} call on
        <a href="{{gcal.htmlLink}}">{{{callDateTime datetime}}}</a> for {{duration}}h
      </h5>
      <p>
        {{#is 'pending' status}}&gt; Awaiting RSVP from {{../../expert.name}}{{/is}}
        {{#is 'confirmed' status}}&gt; {{../../expert.name}} is <strong>available <!--{{status}}--></strong> for this call.{{/is}}
        {{#is 'declined' status}}&gt; {{../../expert.name}} <strong>declined<!--{{status}}--></strong> this call.{{/is}}
      </p>
    </div>
    {{/each}}


    {{#empty calls}} {{else}}
    <hr><h2>expert view, kinda</h2>
    {{/empty}}
    <h2>Unconfirmed Calls</h2>

    {{#each calls}}
    <div class="expert call {{status}}">
      <h5>
        {{type}} call on
        <a href="{{gcal.htmlLink}}">{{{callDateTime datetime}}}</a> for {{duration}}h
      </h5>
      {{#is 'pending' status}}
        <a href="?{{_id}}/yes" class="schedule slim green button">I'm available</a>
        <a href="?{{_id}}/no" class="schedule slim gray button">This time doesn't work for me</a>
      {{/is}}
      {{#is 'confirmed' status}}&gt; You RSVP'd as <strong>available <!--{{status}}--></strong> for this call.
      Change RSVP to <a href="?{{_id}}/yes">declined</a>.
      {{/is}}
      {{#is 'declined' status}}&gt; You <strong>declined<!--{{status}}--></strong> this call.
      Change RSVP to <a href="?{{_id}}/yes">available</a>.
      {{/is}}
    </div>
    {{/each}}

    <h2>Upcoming Calls</h2>
    {{#each calls}}
    <div class="expert call upcoming-{{status}}">
      <h5>
        {{type}} call on
        <a href="{{gcal.htmlLink}}">{{{callDateTime datetime}}}</a> for {{duration}}h
      </h5>
    </div>
    {{/each}}
  </div>

</article>
